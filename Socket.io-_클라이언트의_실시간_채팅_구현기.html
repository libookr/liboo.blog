<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>[Socket.io] 클라이언트의 실시간 채팅 구현기</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="The professional publishing platform" />
<link rel="shortcut icon" href="https://blog.liboo.kr//assets/images/favicon.png" type="image/png" />
<link rel="canonical" href="https://blog.liboo.kr/Socket.io-_%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8%EC%9D%98_%EC%8B%A4%EC%8B%9C%EA%B0%84_%EC%B1%84%ED%8C%85_%EA%B5%AC%ED%98%84%EA%B8%B0" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Liboo.blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="[Socket.io] 클라이언트의 실시간 채팅 구현기" />
    <meta property="og:description" content="https://socket.io/docs/v4/tutorial/introduction 왜 Socket.io인가 기본적으로 WS 모듈과 비교를 해보았을때, room이라는 기능으로 채팅방을 분리하거나, broadcast로 연결된 전체 클라이언트에게 데이터를 보내는 기능들을 더 제공해준다. 또한 WS의 경우 오랜된 브라우저의 경우 지원하지 않는 경우가 있다고 한다. Socket.io는 WS를 기반으로 만들어졌지만 지원이 되지 않는 경우 폴백 처리가 이뤄져 호환성이 더 좋다. Socket.io는 채팅방에 특화된 라이브러리라는" />
    <meta property="og:url" content="https://blog.liboo.kr/Socket.io-_%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8%EC%9D%98_%EC%8B%A4%EC%8B%9C%EA%B0%84_%EC%B1%84%ED%8C%85_%EA%B5%AC%ED%98%84%EA%B8%B0" />
    <meta property="og:image" content="https://blog.liboo.kr/assets/images/writing.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/ghost" />
    <meta property="article:author" content="https://www.facebook.com/ghost" />
    <meta property="article:published_time" content="2024-11-14T06:22:00+00:00" />
    <meta property="article:modified_time" content="2024-11-14T06:22:00+00:00" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="[Socket.io] 클라이언트의 실시간 채팅 구현기" />
    <meta name="twitter:description" content="https://socket.io/docs/v4/tutorial/introduction 왜 Socket.io인가 기본적으로 WS 모듈과 비교를 해보았을때, room이라는 기능으로 채팅방을 분리하거나, broadcast로 연결된 전체 클라이언트에게 데이터를 보내는 기능들을 더 제공해준다. 또한 WS의 경우 오랜된 브라우저의 경우 지원하지 않는 경우가 있다고 한다. Socket.io는 WS를 기반으로 만들어졌지만 지원이 되지 않는 경우 폴백 처리가 이뤄져 호환성이 더 좋다. Socket.io는 채팅방에 특화된 라이브러리라는" />
    <meta name="twitter:url" content="https://blog.liboo.kr/" />
    <meta name="twitter:image" content="https://blog.liboo.kr/assets/images/writing.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Liboo.blog" />
    <meta name="twitter:site" content="@tryghost" />
    <meta name="twitter:creator" content="@tryghost" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Liboo.blog",
        "logo": "https://blog.liboo.kr/assets/images/blog-icon.png"
    },
    "url": "https://blog.liboo.kr/Socket.io-_%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8%EC%9D%98_%EC%8B%A4%EC%8B%9C%EA%B0%84_%EC%B1%84%ED%8C%85_%EA%B5%AC%ED%98%84%EA%B8%B0",
    "image": {
        "@type": "ImageObject",
        "url": "https://blog.liboo.kr/assets/images/writing.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.liboo.kr/Socket.io-_%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8%EC%9D%98_%EC%8B%A4%EC%8B%9C%EA%B0%84_%EC%B1%84%ED%8C%85_%EA%B5%AC%ED%98%84%EA%B8%B0"
    },
    "description": "https://socket.io/docs/v4/tutorial/introduction 왜 Socket.io인가 기본적으로 WS 모듈과 비교를 해보았을때, room이라는 기능으로 채팅방을 분리하거나, broadcast로 연결된 전체 클라이언트에게 데이터를 보내는 기능들을 더 제공해준다. 또한 WS의 경우 오랜된 브라우저의 경우 지원하지 않는 경우가 있다고 한다. Socket.io는 WS를 기반으로 만들어졌지만 지원이 되지 않는 경우 폴백 처리가 이뤄져 호환성이 더 좋다. Socket.io는 채팅방에 특화된 라이브러리라는"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="[Socket.io] 클라이언트의 실시간 채팅 구현기" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://blog.liboo.kr/"><img src="/assets/images/blog-icon.png" alt="Liboo.blog" /></a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-getting-started" role="menuitem"><a href="/tag/getting-started/">Getting Started</a></li>
    <li class="nav-try-ghost" role="menuitem"><a href="https://ghost.org">Try Ghost</a></li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
                <a class="social-link social-link-fb" href="https://facebook.com/ghost" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
</a>
            
            
                <a class="social-link social-link-tw" href="https://twitter.com/tryghost" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Subscribe</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  post ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="14 November 2024">14 November 2024</time>
                    
                </section>
                <h1 class="post-full-title">[Socket.io] 클라이언트의 실시간 채팅 구현기</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/images/writing.jpg)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <p><a href="https://socket.io/docs/v4/tutorial/introduction">https://socket.io/docs/v4/tutorial/introduction</a></p>

<h2 id="왜-socketio인가">왜 Socket.io인가</h2>

<p>기본적으로 WS 모듈과 비교를 해보았을때, room이라는 기능으로 채팅방을 분리하거나, broadcast로 연결된 전체 클라이언트에게 데이터를 보내는 기능들을 더 제공해준다.</p>

<p>또한 WS의 경우 오랜된 브라우저의 경우 지원하지 않는 경우가 있다고 한다. Socket.io는 WS를 기반으로 만들어졌지만 지원이 되지 않는 경우 폴백 처리가 이뤄져 호환성이 더 좋다.</p>

<p>Socket.io는 채팅방에 특화된 라이브러리라는 점에서 각 스트리밍 채널의 다양한 타입의 채팅을 처리해주기에 적절하다고 생각되었다.</p>

<p>소켓 통신과 관련된 node:net과 WS는 이전에 사용해보기도 했기에 Socket.io를 잘 활용해보는 것이 생산성이나 학습 측면에서 좋은 경험이 될 것이라 기대된다.</p>

<h1 id="클라이언트---백-연결과정">클라이언트 - 백 연결과정</h1>

<p><a href="https://socket.io/how-to/use-with-react">https://socket.io/how-to/use-with-react</a></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash
yarn add socket.io-client

</code></pre></div></div>

<p>각 채팅방 별로 메세지를 분리해서 받는 기능 구현</p>

<h2 id="서버">서버</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>javascript
const express = require("express");
const http = require("http");
const { Server } = require("socket.io");

const app = express();
const server = http.createServer(app);
const io = new Server(server, {
  cors: {
    origin: "http://localhost:5173",
    methods: ["GET", "POST"],
  },
});

io.on("connection", (socket) =&gt; {
  console.log("A user connected:", socket.id);

  socket.on("joinRoom", (room) =&gt; {
    socket.join(room);
    console.log(`User ${socket.id} joined room ${room}`);
    socket
      .to(room)
      .emit("receiveMessage", `User ${socket.id} has joined room ${room}`);
  });

  // 클라이언트가 방을 떠날 때
  socket.on("leaveRoom", (room) =&gt; {
    socket.leave(room);
    console.log(`User ${socket.id} left room ${room}`);
  });

  socket.on("sendMessage", ({ room, message }) =&gt; {
    console.log(`Message received in room ${room}: ${message}`);
    io.to(room).emit("receiveMessage", message);
  });

  socket.on("disconnect", () =&gt; {
    console.log("User disconnected:", socket.id);
  });
});

server.listen(8080, () =&gt; {
  console.log("Server is running on http://localhost:8080");
});


</code></pre></div></div>

<h2 id="클라이언트-리액트">클라이언트 (리액트)</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>javascript
import { useEffect, useState } from "react";
import "./App.css";
import io from "socket.io-client";

const socket = io("http://localhost:8080");

function App() {
  const [message, setMessage] = useState("");
  const [messages, setMessages] = useState&lt;string[]&gt;([]);
  const [room, setRoom] = useState("");
  const [currentRoom, setCurrentRoom] = useState(""); // 현재 참여 중인 방을 추적

  useEffect(() =&gt; {
    socket.on("receiveMessage", (newMessage) =&gt; {
      setMessages((prevMessages) =&gt; [...prevMessages, newMessage]);
    });

    return () =&gt; {
      socket.off("receiveMessage");
    };
  }, []);

  const joinRoom = () =&gt; {
    if (room.trim()) {
      // 기존 방이 있으면 나가기
      if (currentRoom) {
        socket.emit("leaveRoom", currentRoom);
      }

      // 새로운 방에 참여
      socket.emit("joinRoom", room);
      setCurrentRoom(room); // 현재 참여 중인 방 업데이트
      setMessages([]); // 방이 바뀔 때 메시지 초기화
    }
  };

  const sendMessage = () =&gt; {
    if (message.trim() &amp;&amp; room) {
      socket.emit("sendMessage", { room, message });
      setMessage("");
    }
  };

  return (
    &lt;div&gt;
      &lt;h1&gt;Chat Room&lt;/h1&gt;
      &lt;div&gt;
        &lt;label&gt;Select a room: &lt;/label&gt;
        &lt;select onChange={(e) =&gt; setRoom(e.target.value)}&gt;
          &lt;option value=""&gt;Choose...&lt;/option&gt;
          &lt;option value="1"&gt;Room 1&lt;/option&gt;
          &lt;option value="2"&gt;Room 2&lt;/option&gt;
          &lt;option value="3"&gt;Room 3&lt;/option&gt;
        &lt;/select&gt;
        &lt;button onClick={joinRoom}&gt;Join Room&lt;/button&gt;
      &lt;/div&gt;

      &lt;div&gt;
        {messages.map((msg, index) =&gt; (
          &lt;p key={index}&gt;{msg}&lt;/p&gt;
        ))}
      &lt;/div&gt;

      &lt;input
        type="text"
        value={message}
        onChange={(e) =&gt; setMessage(e.target.value)}
        placeholder="Type a message..."
      /&gt;
      &lt;button onClick={sendMessage}&gt;Send&lt;/button&gt;
    &lt;/div&gt;
  );
}

export default App;


</code></pre></div></div>

<h2 id="치지직의-채팅-데이터">치지직의 채팅 데이터</h2>

<h3 id="채팅-보내기">채팅 보내기</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>json
{
    "ver": "3", // 프로토콜 버전 (버전 정보)
    "cmd": 3101, // 명령 코드 (이벤트의 종류를 나타냄)
    "svcid": "game", // 서비스 ID (어떤 서비스에서 발생한 이벤트인지 식별)
    "cid": "N1UlG6", // 클라이언트 ID (이벤트가 발생한 클라이언트의 식별자)
    "sid": "VSZR_D50TQJXWM6J1XzLCGHsQikfVFjakLc6LxC5huenPdGXja4pb9Y0CxvLZwZ17wJkDGqcLsWxoGudv0L0Mg--", // 세션 ID (사용자 세션을 고유하게 식별하는 ID)
    "retry": false, // 재시도 여부 (해당 이벤트가 재시도된 것인지 여부)
    "bdy": { // 본문 데이터 (이벤트의 주요 내용)
        "msg": "ㅋㅋㅋㅋ", // 메시지 내용 (사용자가 보낸 텍스트)
        "msgTypeCode": 1, // 메시지 타입 코드 (메시지 유형을 나타내는 코드)
        "extras": "{\"chatType\":\"STREAMING\",\"osType\":\"PC\",\"extraToken\":\"Cc+YfCOlE4/0odC1UwFeEAfs++s/GzveFyfayz8pWzlbf1d1TKyF9t7bdHSrBwPjnRXlXfCxHlXsjD1TWN3jbQ==\",\"streamingChannelId\":\"19e3b97ca1bca954d1ac84cf6862e0dc\",\"emojis\":{}}", // 추가 정보 (JSON 형식으로 포함된 추가 데이터)
        "msgTime": 1731568963648 // 메시지 타임스탬프 (메시지가 발생한 시간, 밀리초 단위)
    },
    "tid": 3 // 트랜잭션 ID (이벤트를 구별하기 위한 고유 식별자)
}

</code></pre></div></div>

<h3 id="채팅-받기">채팅 받기</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>json
{
  "svcid": "game",  // 서비스 ID (예: game, 채팅 서비스 등)
  "ver": "1",  // 버전 (서비스의 버전 정보)
  "bdy": [  // 메시지 본문(body) 배열
    {
      "svcid": "game",  // 서비스 ID (예: game)
      "cid": "N1V4Pr",  // 채팅 세션 ID 또는 메시지의 고유 ID
      "mbrCnt": 2109,  // 현재 채팅방에 참여한 사용자 수
      "uid": "07c7a5dbffe7fb901cceb68a9a731cd1",  // 사용자 고유 ID
      "profile": "{  // 사용자 프로필 정보 (JSON 문자열로 저장됨)
        \"userIdHash\": \"07c7a5dbffe7fb901cceb68a9a731cd1\",  // 사용자 ID 해시 값
        \"nickname\": \"USTARD\",  // 사용자 닉네임
        \"profileImageUrl\": \"\",  // 사용자 프로필 이미지 URL (없을 경우 빈 문자열)
        \"userRoleCode\": \"common_user\",  // 사용자 역할 코드 (예: common_user, 관리자 등)
        \"badge\": null,  // 사용자 배지 정보 (없을 경우 null)
        \"title\": null,  // 사용자 제목 (없을 경우 null)
        \"verifiedMark\": false,  // 사용자 인증 여부 (false: 인증되지 않음)
        \"activityBadges\": [],  // 활동 배지 정보 (없을 경우 빈 배열)
        \"streamingProperty\": {  // 스트리밍 관련 사용자 정보
          \"nicknameColor\": {  // 닉네임 색상 정보
            \"colorCode\": \"CC000\"  // 색상 코드
          },
          \"activatedAchievementBadgeIds\": []  // 활성화된 업적 배지 ID들
        }
      }",
      "msg": "잘생겼네",  // 채팅 메시지 내용
      "msgTypeCode": 1,  // 메시지 유형 코드 (예: 1은 일반 텍스트 메시지, 다른 값은 다른 유형)
      "msgStatusType": "NORMAL",  // 메시지 상태 (예: NORMAL은 일반 메시지, 삭제된 메시지 등)
      "extras": "{  // 메시지 관련 추가 정보 (JSON 문자열로 저장됨)
        \"chatType\": \"STREAMING\",  // 채팅 유형 (예: 스트리밍 채팅)
        \"osType\": \"PC\",  // 운영체제 유형 (예: PC, 모바일 등)
        \"extraToken\": \"HK+d/vpahmIA2m5YJnqtMS/kqPaXti0yEE17mLZGXxyaIy6MzZbzzaf5GJUaavoqq2RSjwfP0d5dp4WgLeAjxg==\",  // 추가 인증 토큰 또는 데이터
        \"streamingChannelId\": \"8a59b34b46271960c1bf172bb0fac758\",  // 스트리밍 채널 ID
        \"emojis\": {}  // 이모지 정보 (없을 경우 빈 객체)
      }",
      "ctime": 1731568455198,  // 메시지 생성 시간 (타임스탬프, 밀리초 단위)
      "utime": 1731568455198,  // 메시지 마지막 수정 시간 (타임스탬프, 밀리초 단위)
      "msgTid": null,  // 메시지의 고유 트랜잭션 ID (없을 경우 null)
      "msgTime": 1731568455198  // 메시지 전송 시간 (타임스탬프, 밀리초 단위)
    }
  ],
  "cmd": 93101,  // 명령 코드 (예: 메시지 전송 명령)
  "tid": "38",  // 트랜잭션 ID (이 메시지가 속한 트랜잭션의 고유 ID)
  "cid": "N1V4Pr"  // 채팅 세션 ID 또는 메시지의 고유 ID
}


</code></pre></div></div>

<h2 id="클라이언트가-필요한-데이터">클라이언트가 필요한 데이터</h2>

<ul>
  <li>cid : 채팅 세션 ID</li>
  <li>streamingChannelId: 스트리밍 채널 ID</li>
  <li>bdy : 메세지 본문
    <ul>
      <li>profile
        <ul>
          <li>uid(userIdHash): 사용자 고유 ID</li>
          <li>userRoleCode : 어떻게 호스트랑 클라이언트의 채팅을 분별할지 논의 필요</li>
          <li>nickname : 사용자 닉네임</li>
          <li>nicknameColor : 사용자 닉네임 색상</li>
        </ul>
      </li>
      <li>msgTypeCode: 메세지 타입 (우리의 경우에는 일반, 질문, 공지로?)</li>
      <li>msgStatusType: 메세지 상태 (질문 채팅의 경우에는 미답변, 답변완료 이렇게?)</li>
      <li>
        <table>
          <tbody>
            <tr>
              <td>ctime</td>
              <td> </td>
              <td>msgTime: 메세지 생성 시간 (만약 다시보기에서 채팅 보여주려면 필요)</td>
            </tr>
          </tbody>
        </table>
      </li>
    </ul>
  </li>
  <li>cmd: 명령코드
    <ul>
      <li>지피티 왈. <strong>채팅 시스템에서 흔히 사용되는 다른 cmd 값들</strong>:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">1001</code>: 채팅방 입장</li>
          <li><code class="language-plaintext highlighter-rouge">1002</code>: 채팅방 퇴장</li>
          <li><code class="language-plaintext highlighter-rouge">2001</code>: 메시지 전송</li>
          <li><code class="language-plaintext highlighter-rouge">2002</code>: 메시지 삭제</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="클라이언트-설계">클라이언트 설계</h2>

<p>채팅 컴포넌트(ChatRoom)에서 소켓 연결을 설정하는 것이 적절하다고 판단.</p>

<p><a href="https://github.com/boostcampwm2023/web05-AlgoITNi/blob/dev/frontEnd/src/components/room/ChattingSection.tsx#L9">link_preview</a></p>

<p>활용방식 참고</p>

<ol>
  <li>연결될 소켓 url을 구하고 (엔드포인트 + 채널 번호)</li>
  <li>createSocket으로 클라이언트 소켓 생성</li>
  <li>Socket.connect</li>
  <li>emit으로 지정된 cmd 전송 (처음 진입시 JOIN_ROOM과 같은 명령어)</li>
  <li>컴포넌트 state로 socket set</li>
  <li>input 컴포넌트에는 socket 객체도 전달</li>
</ol>

<p>전역상태로 socket을 가지게 하면 안되나?</p>

<p>없거나 에러가 날때만 socket 재생성 및 conect 되도록..</p>

<p>고려해야할 부분</p>

<ol>
  <li>채팅창 닫을시에 chatroom 언마운트가 되면 안됨. 연결은 유지되어야한다.</li>
  <li>공지가 오면 바로 보여줘야함</li>
  <li>질문 탭은 어떻게 분리? 걍 클라이언트에서만??
    <ol>
      <li>가져온 메세지 리스트에서 질문 채팅만 필터링하고 거기서 답변미완료 질문을 또 필터링? 과정이 너무 길다</li>
      <li>차라리 이벤트 분리를 해서 채팅과 질문탭이 따로 관리되도록하면 더 좋을 것 같기도…………..</li>
    </ol>
  </li>
  <li>결론 : 이벤트 설계만 잘해두면 생각보다는 덜 어려운듯</li>
</ol>

<p>메인 페이지 스트리밍 띄워주기는 SSE가 가장 낫지않을까?</p>

<p><img src="/upload/2024-11-14-[Socket.io]_클라이언트의_실시간_채팅_구현기.md/0.png" alt="0" /><em>image.png</em></p>

<p>암튼 데모는 완료~</p>


                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Subscribe to Liboo.blog</h3>
                    <p>Get the latest posts delivered right to your inbox</p>
                    <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>

                </section>
            

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                
                    
                
                    
                
                    
                
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/%EB%AA%A8%EB%85%B8%EB%A0%88%ED%8F%AC_CI_CD_%EC%8B%9C%EA%B0%84_%EC%A4%84%EC%9D%B4%EA%B8%B0">
                <div class="post-card-image" style="background-image: url(/upload/2024-11-14-모노레포_CI_CD_시간_줄이기.md/0.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/%EB%AA%A8%EB%85%B8%EB%A0%88%ED%8F%AC_CI_CD_%EC%8B%9C%EA%B0%84_%EC%A4%84%EC%9D%B4%EA%B8%B0">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Devops</span>
                            
                        
                    

                    <h2 class="post-card-title">모노레포 CI CD 시간 줄이기</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>https://www.youtube.com/watch?v=2IE68SDTYvI

</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                    
                
                    
                
                    
                
                    
                
                <span class="reading-time">
                    
                    
                      1 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/nestjs%EC%97%90%EC%84%9C_swagger_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0">
                <div class="post-card-image" style="background-image: url(/assets/images/writing.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/nestjs%EC%97%90%EC%84%9C_swagger_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0">
                <header class="post-card-header">
                    

                    <h2 class="post-card-title">nestjs에서 swagger 사용해보기</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>서론

</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                    
                
                    
                
                    
                
                    
                
                <span class="reading-time">
                    
                    
                      1 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://blog.liboo.kr/">
            
                <img src="/assets/images/favicon.png" alt="Liboo.blog icon" />
            
            <span>Liboo.blog</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">[Socket.io] 클라이언트의 실시간 채팅 구현기</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=%5BSocket.io%5D+%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8%EC%9D%98+%EC%8B%A4%EC%8B%9C%EA%B0%84+%EC%B1%84%ED%8C%85+%EA%B5%AC%ED%98%84%EA%B8%B0&amp;url=https://jekyllt.github.io/jasper2/Socket.io-_%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8%EC%9D%98_%EC%8B%A4%EC%8B%9C%EA%B0%84_%EC%B1%84%ED%8C%85_%EA%B5%AC%ED%98%84%EA%B8%B0"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://jekyllt.github.io/jasper2/Socket.io-_%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8%EC%9D%98_%EC%8B%A4%EC%8B%9C%EA%B0%84_%EC%B1%84%ED%8C%85_%EA%B5%AC%ED%98%84%EA%B8%B0"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://blog.liboo.kr/">Liboo.blog</a> &copy; 2024</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyllt/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    <a href="https://facebook.com/ghost" target="_blank" rel="noopener">Facebook</a>
                    <a href="https://twitter.com/tryghost" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                    <img class="subscribe-overlay-logo" src="/assets/images/blog-icon.png" alt="Liboo.blog" />
                
                <h1 class="subscribe-overlay-title">Subscribe to Liboo.blog</h1>
                <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
                <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>

            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69281367-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
